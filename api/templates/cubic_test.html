<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Physicsium - Cubic Crystal Builder</title>

<!-- GlowScript CSS -->
<link rel="stylesheet" href="https://www.glowscript.org/css/redmond/2.1/jquery-ui.custom.css" />
<link rel="stylesheet" href="https://www.glowscript.org/css/ide.css" />

<!-- GlowScript & jQuery -->
<script src="https://www.glowscript.org/lib/jquery/2.1/jquery.min.js"></script>
<script src="https://www.glowscript.org/lib/jquery/2.1/jquery-ui.custom.min.js"></script>
<script src="https://www.glowscript.org/package/glow.3.2.min.js"></script>
<script src="https://www.glowscript.org/package/RSrun.3.2.min.js"></script>

<style>
  body {
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: white;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    align-items: center;
    justify-content: flex-start;
    padding: 2rem 1rem;
    margin: 0;
  }
  h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    font-weight: 900;
    text-align: center;
    text-shadow: 0 0 10px rgba(255,255,255,0.5);
  }
  form {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px 30px;
    border-radius: 12px;
    box-shadow: 0 0 15px rgba(90, 200, 250, 0.5);
    margin-bottom: 2rem;
    width: 100%;
    max-width: 450px;
  }
  label, select, input {
    font-size: 1rem;
    display: block;
    margin: 10px 0 6px 0;
    color: #cce0ffcc;
  }
  select, input[type=number] {
    width: 100%;
    padding: 8px 10px;
    font-size: 1rem;
    border-radius: 6px;
    border: none;
    outline: none;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    transition: background-color 0.3s;
  }
  select:hover, input[type=number]:hover,
  select:focus, input[type=number]:focus {
    background: rgba(255, 255, 255, 0.35);
  }
  button {
    background: rgba(255,255,255,0.1);
    border: 2px solid #5ac8fa;
    border-radius: 12px;
    padding: 12px 20px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    color: white;
    box-shadow: 0 0 10px rgba(90, 200, 250, 0.5);
    transition: background-color 0.3s, color 0.3s, transform 0.2s;
    user-select: none;
    margin: 0 5px 10px 0;
  }
  button:hover,
  button:focus {
    background-color: #5ac8fa;
    color: #1e3c72;
    transform: scale(1.05);
    outline: none;
  }
  #glowscript {
    width: 100%;
    max-width: 900px;
    height: 60vh;
    min-height: 400px;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(90, 200, 250, 0.6);
    border: 2px solid #5ac8fa;
    margin-bottom: 2rem;
  }
  footer {
    margin-top: auto;
    font-size: 0.9rem;
    color: #cce0ffaa;
    user-select: none;
    text-align: center;
  }

  /* Responsive tweaks */
  @media (max-width: 480px) {
    h1 {
      font-size: 2rem;
    }
    form {
      padding: 15px 20px;
    }
    button {
      width: 48%;
      margin-bottom: 10px;
    }
  }
</style>
</head>
<body>

<h1>Physicsium - Cubic Crystal Builder</h1>

<form id="crystalForm">
  <label for="crystalType">Select Cubic Crystal Type:</label>
  <select id="crystalType" required>
    <option value="sc">Simple Cubic (SC)</option>
    <option value="bcc">Body-Centered Cubic (BCC)</option>
    <option value="fcc">Face-Centered Cubic (FCC)</option>
  </select>

  <label for="numCells">Number of Unit Cells per Side (1 to 5):</label>
  <input type="number" id="numCells" value="2" min="1" max="5" step="1" required />

  <button type="button" id="createBtn">Create Crystal</button>
  <button type="button" id="clearBtn">Clear</button>
</form>

<div id="glowscript" class="glowscript"></div>

<footer>&copy; 2025 Physicsium</footer>

<script type="text/javascript">
(function () {
  async function __main__() {
    // Responsive canvas
    let scene = canvas({
      width: Math.min(window.innerWidth * 0.95, 900),
      height: window.innerHeight * 0.6,
      title: "Cubic Crystal Viewer",
      background: vec(0.1, 0.15, 0.25)
    });

    scene.userZoom = true;
    scene.userRotate = true;

    // Axes
    const axisLength = 6;
    const axisThickness = 0.05;
    box({ pos: vec(axisLength / 2, 0, 0), size: vec(axisLength, axisThickness, axisThickness), color: color.red });
    box({ pos: vec(0, axisLength / 2, 0), size: vec(axisThickness, axisLength, axisThickness), color: color.green });
    box({ pos: vec(0, 0, axisLength / 2), size: vec(axisThickness, axisThickness, axisLength), color: color.blue });

    let atoms = [];

    function clearAtoms() {
      for (let a of atoms) {
        a.visible = false;
        if (a.delete) a.delete();
      }
      atoms = [];
    }

    function createSC(numCells) {
      clearAtoms();
      const a = 1.5;
      const r = a / 2;
      for (let x = 0; x < numCells; x++)
        for (let y = 0; y < numCells; y++)
          for (let z = 0; z < numCells; z++)
            atoms.push(sphere({ pos: vec(x * a, y * a, z * a), radius: r, color: color.orange }));
    }

    function createBCC(numCells) {
      clearAtoms();
      const a = 1.5;
      const r = (Math.sqrt(3) * a) / 4;
      for (let x = 0; x < numCells; x++)
        for (let y = 0; y < numCells; y++)
          for (let z = 0; z < numCells; z++) {
            atoms.push(sphere({ pos: vec(x * a, y * a, z * a), radius: r, color: color.cyan }));
            if (x < numCells - 1 && y < numCells - 1 && z < numCells - 1) {
              atoms.push(sphere({ pos: vec(x * a + a / 2, y * a + a / 2, z * a + a / 2), radius: r, color: color.cyan }));
            }
          }
    }

    function createFCC(numCells) {
      clearAtoms();
      const a = 1.5;
      const r = a / (2 * Math.sqrt(2));
      for (let x = 0; x < numCells; x++)
        for (let y = 0; y < numCells; y++)
          for (let z = 0; z < numCells; z++) {
            atoms.push(sphere({ pos: vec(x * a, y * a, z * a), radius: r, color: color.magenta }));
            if (x < numCells - 1 && y < numCells - 1)
              atoms.push(sphere({ pos: vec(x * a + a / 2, y * a + a / 2, z * a), radius: r, color: color.magenta }));
            if (x < numCells - 1 && z < numCells - 1)
              atoms.push(sphere({ pos: vec(x * a + a / 2, y * a, z * a + a / 2), radius: r, color: color.magenta }));
            if (y < numCells - 1 && z < numCells - 1)
              atoms.push(sphere({ pos: vec(x * a, y * a + a / 2, z * a + a / 2), radius: r, color: color.magenta }));
          }
    }

    window.createSC = createSC;
    window.createBCC = createBCC;
    window.createFCC = createFCC;
    window.clearAtoms = clearAtoms;
  }

  $(function () {
    window.__context = { glowscript_container: $("#glowscript").removeAttr("id") };
    __main__().then(() => {
      $('#createBtn').click(() => {
        let crystalType = $('#crystalType').val();
        let numCells = parseInt($('#numCells').val());
        if (isNaN(numCells) || numCells < 1 || numCells > 5) {
          alert('Please enter a valid number of unit cells between 1 and 5.');
          return;
        }
        if (crystalType === 'sc') window.createSC(numCells);
        else if (crystalType === 'bcc') window.createBCC(numCells);
        else if (crystalType === 'fcc') window.createFCC(numCells);
      });

      $('#clearBtn').click(() => {
        window.clearAtoms();
      });
    });
  });
})();
</script>

</body>
</html>
